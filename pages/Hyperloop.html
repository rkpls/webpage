
<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Projekt Hyperloop</title>
    <link rel="stylesheet" href="pages.css">
    <link rel="icon" href="./icons/RP.PNG">
</head>

<body>
    <div class="main">
        <h1>Adler Interface</h1>
        <div class="content">
        <h2>Input</h2>
        <form action="/submit" method="post">
            <label for="power_input">Power:</label>
            <input type="range" id="power_input" name="power_input" min="-100" max="100" oninput="updateValue(this.value)" style="width: 400px;" required>
            <br>
            <span id="valueDisplay">0</span>
        </form>
        </p>
        <p>
            <h2>Output</h2>
            <div id="log">Terminal:</div>
            <div id="chart_div"></div>
            <div id="chart_div"></div>
        </p>
        </div>
        <div class="content">
        <p>
            Datasheets: <br>
            <a href="Vishay-TCST1103-datasheet.pdf">Phototransistor</a><br>
            <a href="HCSR04.pdf">Radar</a>
        </p>
        </div>
    </div>
    <script>
        // load current chart package
        google.charts.load("current", {
        packages: ["corechart", "line"]
        });
        // set callback function when api loaded
        google.charts.setOnLoadCallback(drawChart);

        document.getElementById("power_input").value = 0;

        function updateValue(value) {
            document.getElementById("valueDisplay").textContent = value;
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "/submit", true);
            xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
            xhr.send(value);
        }

        // Update Terminal
        function updateLog(message) {
            var logElement = document.getElementById("log");
            logElement.textContent += message + '\n';
        }

        function drawChart() {
            // create data object with default value
            let data = google.visualization.arrayToDataTable([
              ['Time', 'Volts', 'Amps'],
              [0, 0, 0],
            ]);
            // create options object with titles, colors, etc.
            let options = {
              title: "V/A",
              hAxis: {
                textPosition: 'none',
              },
              vAxis: {
                title: "t"
              }
            };
            // draw chart on load
            let chart = new google.visualization.LineChart(
              document.getElementById("chart_div")
            );
            chart.draw(data, options);
          }

        // WebSocket Connection
        var socket = new WebSocket("ws://" + window.location.hostname + "/log");
        socket.onmessage = function(event) {
            var logMessage = event.data;
            updateLog(logMessage);
        }
    </script>
<footer>
    &copy; rikopals.com | rikopals.de
    <br>
    Powered by <a href="https://www.ionos.de">Ionos</a> | Kontakt via <a href="mailto:info@rikopals.de">Mail</a>
</footer>

</body>
</html>